# 25秒自动剪辑工具

这是一个自动视频剪辑工具，可以将任意长度的视频自动剪辑为25秒的精彩片段。该工具会保留原视频前25秒的音频，并随机选取视频片段与音频进行匹配。

## 功能特点

- 自动将视频剪辑为25秒长度
- 保留原始视频前25秒的音频
- 随机选取视频片段进行组合
- 自动添加平滑转场效果
- 保持原始视频质量

## 最新功能说明

- 智能场景检测：使用内容感知的场景检测，避免在场景中间切断
- 保留关键场景：自动保留视频开头和结尾的重要场景
- 随机选择中间场景：在保持时序的同时，随机选择中间部分的精彩片段
- 保持原始质量：直接复制视频流，不损失画质
- 高品质音频：使用高比特率音频编码，确保音质

## 环境要求

- Python 3.8+
- moviepy
- opencv-python
- numpy
- scenedetect

## 安装

1. 克隆项目到本地：
```bash
git clone [项目地址]
```

2. 安装依赖：
```bash
pip install -r requirements.txt
pip install scenedetect
```

## 使用方法

1. 将要剪辑的视频文件放在 `input` 文件夹中
2. 运行程序：
```bash
python main.py --input 你的视频文件名.mp4
```
3. 处理完成后，可以在 `output` 文件夹中找到剪辑好的视频

## 工作原理

1. 场景检测
   - 使用 PySceneDetect 库检测视频中的自然场景变化
   - 过滤掉过短的场景（小于0.5秒）

2. 场景选择
   - 保留开头的两个场景
   - 保留结尾的两个场景
   - 从中间部分随机选择场景，但保持原有时序

3. 视频处理
   - 使用 FFmpeg 直接复制视频流，保持原始质量
   - 提取并保留前25秒的音频
   - 使用高品质设置（320k AAC）处理音频

## 示例输出

处理过程会显示详细的进度信息：
```
正在加载视频: test.mp4
视频总时长: 35.16秒
提取音频...
检测场景变化...
选择场景...
提取选中的场景...
提取场景: 0.0s - 3.1s (开头)
提取场景: 3.1s - 5.9s (开头)
[中间场景]
提取场景: 29.7s - 32.4s (结尾)
提取场景: 32.4s - 35.2s (结尾)
合并场景...
添加音频...
处理完成！
```

## 项目结构

```
.
├── README.md
├── requirements.txt
├── main.py           # 主程序
├── video_editor.py   # 视频处理核心类
├── input/           # 输入视频目录
└── output/          # 输出视频目录
```

## 注意事项

- 支持的视频格式：mp4, mov, avi
- 建议输入视频时长大于25秒
- 处理过程中请勿关闭程序
- 确保有足够的磁盘空间

## 后续计划

- [ ] 添加图形用户界面
- [ ] 支持自定义输出时长
- [ ] 添加更多转场效果
- [ ] 优化视频片段选择算法
- [ ] 添加进度条显示

## 更新日志

### v1.1.0
- 添加智能场景检测
- 实现开头和结尾场景保留
- 优化视频质量保持机制
- 提升音频处理质量

### v1.0.0
- 初始版本发布
- 基本视频剪辑功能

## 许可证

MIT License

## 在线部署

本项目支持通过GitHub和Zeabur进行在线部署，使您能够在网页上使用视频剪辑功能。

### 部署步骤

1. **GitHub准备**
   - Fork本仓库到您的GitHub账号
   - 确保您的仓库中包含以下文件：
     - `requirements.txt`：依赖包列表
     - `app.py`：主要的Streamlit应用程序文件
     - 其他必要的Python模块文件

2. **Zeabur部署**
   - 注册并登录[Zeabur](https://zeabur.com)账号
   - 创建新项目
   - 连接您的GitHub仓库
   - 选择部署的分支（通常是main或master）
   - 配置环境变量（如需要）
   - 选择Python运行环境
   - 设置构建命令：`pip install -r requirements.txt`
   - 设置启动命令：`streamlit run app.py`

### 环境配置

确保在Zeabur中配置以下环境：
- Python 3.8+
- FFmpeg（Zeabur环境中预装）
- 所有requirements.txt中列出的依赖包

### 注意事项

1. **文件存储**
   - 在线版本使用临时存储处理视频文件
   - 建议处理的视频大小不超过500MB
   - 处理完成后及时下载结果文件

2. **性能考虑**
   - 视频处理可能需要一定时间，请耐心等待
   - 建议使用较小的视频文件进行测试

3. **安全性**
   - 确保不要在代码中包含敏感信息
   - 必要的API密钥等信息应通过环境变量配置

### 本地开发

如果您想在部署前进行本地测试：

```bash
# 1. 克隆仓库
git clone [您的仓库地址]

# 2. 安装依赖
pip install -r requirements.txt

# 3. 运行Streamlit应用
streamlit run app.py
```

### 故障排除

如果遇到部署问题，请检查：
1. requirements.txt 是否包含所有必要的依赖
2. 是否正确配置了环境变量
3. 日志输出中是否有错误信息

### 技术支持

如果您在部署过程中遇到任何问题，请：
1. 查看Zeabur的官方文档
2. 检查项目的Issues页面
3. 提交新的Issue寻求帮助
